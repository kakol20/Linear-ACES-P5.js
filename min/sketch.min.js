const Manager=function(){var e,i,n,o,t,a,r,$,g,h,c,d,u,f=!1,l=!1,s=0,p=0,_=0,v=0,w=31,T=!0,k=!0,m=!0,S=5e3;function b(i){e.position(5,i);var n=i+e.height+5;$.position(5,n),$.mousePressed(E),n+=$.height+10,h.position(5,n),n+=h.height+10,c.position(5,n),n+=c.height+5,d.position(5,n),u.position(d.width+25,n),n+=u.height+10,r.position(5,n),n+=r.height+5,a.position(5,n),t.position(a.width+20,n)}function M(e,i,n){return(e+i*n)*4}function y(e){"image"==e.type&&(n=createImg(e.data,"","anonymous",D)).hide()}function D(){resizeCanvas(n.width,n.height),i=new ImgWrap(width,height,ColorSpace.sRGB),background(28,28,28,0),image(n,0,0),f=!0,l=!1,o=!0,g=!1}function E(){console.log("restart"),o&&(f=!0,l=!1,g=!0,background(0,0,0,0))}return{preload:function(){e=createFileInput(y),$=createButton("Restart"),a=createSpan("Dither Factor: "),t=createInput(31,"number"),(r=createCheckbox(" Toggle Dither",!0)).changed(()=>{console.log("Dither toggle: "+r.checked())}),(h=createCheckbox(" Toggle ACES",!0)).changed(()=>{console.log("ACES toggle: "+h.checked())}),(c=createCheckbox(" Toggle Kelvin Tint",!1)).changed(()=>{console.log("Kelvin Tint toggle: "+c.checked())}),d=createSpan("Kelvin Temperature: "),u=createInput(5e3,"number"),b(5)},setup:function(){createCanvas(windowWidth,windowHeight),loop()},draw:function(){if(!0===f){if(o){_=width*height,v=.016666666666666666*1e3,w=t.value(),T=r.checked(),k=h.checked(),m=c.checked(),S=u.value(),b(height+5),loadPixels(),g?g=!1:i.loadPixels(pixels);for(var e=0;e<width;e++)for(var n=0;n<height;n++)for(var a=i.index(e,n),$=0;$<4;$++){var d=i.forOutput(a+$);pixels[a+$]=255*d}updatePixels(),l=!0,s=0,p=0}else alert("Try choosing image again");f=!1}else if(l&&!f){loadPixels();for(var M=new Date,y=0;y<_;y++){var D,E,R,a=(D=s,E=p,R=width,(D+E*R)*4),C=[i.data[a+0],i.data[a+1],i.data[a+2],i.data[a+3]];k&&(C=LinearACES.ToneMap(C[0],C[1],C[2],C[3]));for(var $=0;$<4;$++)$<3&&(C[$]=sRGB.toSRGB(C[$]));m&&(C=Kelvin.Tint(C,S));for(var $=0;$<4;$++)T&&(C[$]=Dither.bayerSingle(s,p,C[$],w)),pixels[a+$]=Math.round(255*C[$])>>>0;if(++s>=width&&(s=0,p++),p>=height){l=!1,console.log("-----PROCESS DONE -----");break}if(new Date-M>=v)break}updatePixels()}}}}();function preload(){Manager.preload()}function setup(){Manager.setup()}function draw(){Manager.draw()}