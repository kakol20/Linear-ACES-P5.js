const Manager=function(){var e,t,i,n,o,a,$,r,g,h,c,d,l,u=!1,f=!1,s=0,p=0,_=0,v=0,w=31,T=!0,k=!0,m=!0,S=5e3;function b(t){e.position(5,t);var i=t+e.height+5;r.position(5,i),r.mousePressed(E),i+=r.height+10,h.position(5,i),i+=h.height+10,c.position(5,i),i+=c.height+5,d.position(5,i),l.position(d.width+25,i),i+=l.height+10,$.position(5,i),i+=$.height+5,a.position(5,i),o.position(a.width+20,i)}function M(e,t,i){return(e+t*i)*4}function y(e){"image"==e.type&&(i=createImg(e.data,"","anonymous",D)).hide()}function D(){resizeCanvas(i.width,i.height),t=new ImgWrap(width,height,ColorSpace.sRGB),background(28,28,28,0),image(i,0,0),u=!0,f=!1,n=!0,g=!1}function E(){console.log("restart"),n&&(u=!0,f=!1,g=!0,background(0,0,0,0))}return{preload:function(){e=createFileInput(y),r=createButton("Restart"),a=createSpan("Dither Factor: "),o=createInput(31,"number"),($=createCheckbox(" Toggle Dither",!0)).changed(()=>{console.log("Dither toggle: "+$.checked())}),(h=createCheckbox(" Toggle ACES",!0)).changed(()=>{console.log("ACES toggle: "+h.checked())}),(c=createCheckbox(" Toggle Kelvin Tint",!1)).changed(()=>{console.log("Kelvin Tint toggle: "+c.checked())}),d=createSpan("Kelvin Temperature: "),l=createInput(5e3,"number"),b(5)},setup:function(){createCanvas(windowWidth,windowHeight),loop()},draw:function(){if(!0===u){if(n){_=width*height,v=.016666666666666666*1e3,w=o.value(),T=$.checked(),k=h.checked(),m=c.checked(),S=l.value(),b(height+5),loadPixels(),g?g=!1:t.loadPixels(pixels);for(var e=0;e<width;e++)for(var i=0;i<height;i++){let a=t.index(e,i);for(var r=0;r<4;r++){var d=t.forOutput(a+r);pixels[a+r]=255*d}}updatePixels(),f=!0,s=0,p=0}else alert("Try choosing image again");u=!1}else if(f&&!u){loadPixels();let M=new Date;for(var y=0;y<_;y++){let D=(E=s,R=p,C=width,(E+R*C)*4);var E,R,C,K=[t.data[D+0],t.data[D+1],t.data[D+2],t.data[D+3]];k&&(K=LinearACES.ToneMap(K[0],K[1],K[2],K[3]));for(var r=0;r<4;r++)r<3&&(K[r]=sRGB.toSRGB(K[r]));m&&(K=Kelvin.Tint(K,S));for(var r=0;r<4;r++)T&&(K[r]=Dither.bayerSingle(s,p,K[r],w)),pixels[D+r]=Math.round(255*K[r])>>>0;if(++s>=width&&(s=0,p++),p>=height){f=!1,console.log("-----PROCESS DONE -----");break}let O=new Date,P=O-M;if(P>=v)break}updatePixels()}}}}();function preload(){Manager.preload()}function setup(){Manager.setup()}function draw(){Manager.draw()}