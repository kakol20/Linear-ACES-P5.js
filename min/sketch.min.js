const Manager=function(){var e,t,i,o,n,a,$,r,g,h,c,d,l,u=!1,f=!1,s=0,p=0,_=0,v=31,T=!0,k=!0,m=!0,w=5e3;function S(t){e.position(5,t);var i=t+e.height+5;r.position(5,i),r.mousePressed(D),i+=r.height+10,h.position(5,i),i+=h.height+10,c.position(5,i),i+=c.height+5,d.position(5,i),l.position(d.width+25,i),i+=l.height+10,$.position(5,i),i+=$.height+5,a.position(5,i),n.position(a.width+20,i)}function M(e,t,i){return(e+t*i)*4}function b(e){"image"==e.type&&(i=createImg(e.data,"","anonymous",y)).hide()}function y(){resizeCanvas(i.width,i.height),t=new ImgWrap(width,height,ColorSpace.sRGB),background(28,28,28,0),image(i,0,0),u=!0,f=!1,o=!0,g=!1}function D(){console.log("restart"),o&&(u=!0,f=!1,g=!0,background(0,0,0,0))}return{preload:function(){e=createFileInput(b),r=createButton("Restart"),a=createSpan("Dither Factor: "),n=createInput(31,"number"),($=createCheckbox(" Toggle Dither",!0)).changed(()=>{console.log("Dither toggle: "+$.checked())}),(h=createCheckbox(" Toggle ACES",!0)).changed(()=>{console.log("ACES toggle: "+h.checked())}),(c=createCheckbox(" Toggle Kelvin Tint",!1)).changed(()=>{console.log("Kelvin Tint toggle: "+c.checked())}),d=createSpan("Kelvin Temperature: "),l=createInput(5e3,"number"),S(5)},setup:function(){createCanvas(windowWidth,windowHeight),loop()},draw:function(){if(!0===u){if(o){_=width,v=n.value(),T=$.checked(),k=h.checked(),m=c.checked(),w=l.value(),S(height+5),loadPixels(),g?g=!1:t.loadPixels(pixels);for(var e=0;e<width;e++)for(var i=0;i<height;i++){let a=t.index(e,i);for(var r=0;r<4;r++){var d=t.forOutput(a+r);pixels[a+r]=255*d}}updatePixels(),f=!0,s=0,p=0}else alert("Try choosing image again");u=!1}else if(f&&!u){loadPixels();for(var M=0;M<_;M++){let b=(D=s,E=p,R=width,(D+E*R)*4);if(b+4*_<t.data.length){let y=b+4*_;pixels[y+0]=0+.75*pixels[y+0],pixels[y+1]=63.75+.75*pixels[y+1],pixels[y+2]=0+.75*pixels[y+2],pixels[y+3]=63.75+.75*pixels[y+3]}var D,E,R,C=[t.data[b+0],t.data[b+1],t.data[b+2],t.data[b+3]];k&&(C=LinearACES.ToneMap(C[0],C[1],C[2],C[3]));for(var r=0;r<4;r++)r<3&&(C[r]=sRGB.toSRGB(C[r]));m&&(C=Kelvin.Tint(C,w));for(var r=0;r<4;r++)T&&(C[r]=Dither.bayerSingle(s,p,C[r],v)),pixels[b+r]=Math.round(255*C[r])>>>0;if(++s>=width&&(s=0,p++),p>=height){f=!1,console.log("-----PROCESS DONE -----");break}}updatePixels()}}}}();function preload(){Manager.preload()}function setup(){Manager.setup()}function draw(){Manager.draw()}