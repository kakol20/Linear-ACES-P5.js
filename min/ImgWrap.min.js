const ColorSpace={sRGB:"sRGB",Linear:"Linear"};class ImgWrap{constructor(t,i,a){this.width=t,this.height=i,this.size=this.width*this.height*4,this.colorSpace=a}loadPixels(t){for(var i in this.data=Array(this.size),t)this.data[i]=t[i]/255,(i+1)%4>0&&this.colorSpace==ColorSpace.sRGB&&(this.data[i]=sRGB.toLinear(this.data[i]))}index(t,i){return(t+i*this.width)*4}indexToXY(t){var i,a=Math.floor(t/4);return[a%this.width,a/this.width]}toBW(){for(var t=0;t<this.width;t++)for(var i=0;i<this.height;i++){var a=this.index(t,i),h=.2989*this.data[a+0]+.587*this.data[a+1]+.114*this.data[a+2];this.data[a+0]=h,this.data[a+1]=h,this.data[a+2]=h}}forOutput(t){var i=this.data[t];return this.colorSpace===ColorSpace.sRGB&&(t+1)%4>0&&(i=sRGB.toSRGB(i)),i}}