const ColorSpace={sRGB:"sRGB",Linear:"Linear"};class ImgWrap{constructor(t,a,i,s){this.width=t,this.height=a,this.size=0,this.colorSpace=i}loadPixels(t){this.size=t.length,this.data=Array(this.size);for(var a=0;a<t.length;a++)this.data[a]=t[a]/255,(a+1)%4>0&&this.colorSpace==ColorSpace.sRGB&&(this.data[a]=sRGB.toLinear(this.data[a]))}index(t,a,i){return(t+a*this.width)*4*i}toBW(){for(var t=0;t<this.width;t++)for(var a=0;a<this.height;a++){var i=this.index(t,a),s=.2989*this.data[i+0]+.587*this.data[i+1]+.114*this.data[i+2];this.data[i+0]=s,this.data[i+1]=s,this.data[i+2]=s}}forOutput(t){var a=this.data[t];return this.colorSpace===ColorSpace.sRGB&&(t+1)%4>0&&(a=sRGB.toSRGB(a)),a}}